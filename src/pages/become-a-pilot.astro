---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeaderScreen from "../components/HeaderScreen.astro";
import becomePilotData from "../data/becomePilotData";
import StepsGrid from "../components/StepsGrid.astro";
import CTAWhyUs2 from "../components/CTAWhyUs2.astro";
import FAQs from "../components/FAQs";
import FAQSchema from "../components/FAQSchema.astro";
import { GeneralFAQs } from "../data/general-faqs";
import PodcastCTA from "../components/PodcastCTA.astro";

// Transform FAQ format for schema
const faqSchemaItems = GeneralFAQs.map((faq) => ({
  question: faq.title,
  // Remove HTML tags for clean schema
  answer: faq.content.replace(/<[^>]*>?/gm, ""),
}));

const has = (obj, key) => obj && Array.isArray(obj[key]) && obj[key].length;

---

<BaseLayout
  siteTitle={becomePilotData.pageTitle}
  siteDescription={becomePilotData.pageDescription}
  keywords={becomePilotData.pageKeywords}
>
  <HeaderScreen content={becomePilotData.header} />
  <CTAWhyUs2 content={becomePilotData.cta} />
  <StepsGrid content={becomePilotData.stepItems} />
  <FAQs faqs={GeneralFAQs} type="General" client:visible />
  <FAQSchema items={faqSchemaItems} />
  <PodcastCTA />

</BaseLayout>
