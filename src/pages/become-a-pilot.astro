---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeaderScreen from "../components/HeaderScreen.astro";
import becomePilotData from "../data/becomePilotData";
import CTAWhyUs2 from "../components/CTAWhyUs2.astro";
import FAQs from "../components/FAQs";
import FAQSchema from "../components/FAQSchema.astro";
import { GeneralFAQs } from "../data/general-faqs";
import CTAPodcast from "../components/CTAPodcast.astro";
import BecomePilotSteps from "../components/BecomePilotSteps.astro";
import SingleTestimony from "../components/SingleTestimony.astro";
import flyWithUsCTA from "../data/fly-with-us-cta";
import CTAColor from "../components/CTAColor.astro";
import StepsAccordion from "../components/StepsAccordion.jsx";
import HeaderSmall from "../components/HeaderSmall.astro";

// Transform FAQ format for schema
const faqSchemaItems = GeneralFAQs.map((faq) => ({
  question: faq.title,
  // Remove HTML tags for clean schema
  answer: faq.content.replace(/<[^>]*>?/gm, ""),
}));

const has = (obj, key) => obj && Array.isArray(obj[key]) && obj[key].length;
---

<BaseLayout
  siteTitle={becomePilotData.pageTitle}
  siteDescription={becomePilotData.pageDescription}
  keywords={becomePilotData.pageKeywords}
  showBreadcrumbs={false}
  pageType="programs"
  includeOrganizationSchema={true}
  includeServiceSchema={true}
  includeCourseSchema={true}
  enableKeywordOptimization={true}
  enableAdvancedTitleStrategy={false}
>
  <!-- HEADER -->
  <HeaderSmall content={becomePilotData.header} />
  <CTAWhyUs2 content={becomePilotData.cta} />
  <BecomePilotSteps content={becomePilotData.steps} />
  <StepsAccordion content={becomePilotData?.roadmapItems} client:load />
  <CTAColor content={flyWithUsCTA} />
  <SingleTestimony />

  <CTAPodcast />
</BaseLayout>
